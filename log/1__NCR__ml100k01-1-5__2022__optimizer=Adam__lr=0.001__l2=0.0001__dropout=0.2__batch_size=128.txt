INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:building train history csv...
INFO:root:building vt history csv...
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213696
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0254,0.0434,0.0456,0.1019 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 1.5880,1.5880 validation= 0.0358,0.0524,0.0626,0.1136 test= 0.0251,0.0431,0.0456,0.1019 [7.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 31.1298, l2 = 0.0133
WARNING:root:l2 inappropriate: loss = 31.1298, l2 = 0.0133
INFO:root:Epoch     1 [73.3 s]	 train= 4.2129,4.0682 validation= 0.1845,0.2372,0.2728,0.4363 test= 0.1715,0.2188,0.2537,0.4013 [6.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 38.6820, l2 = 0.0210
WARNING:root:l2 inappropriate: loss = 38.6820, l2 = 0.0210
INFO:root:Epoch     2 [76.8 s]	 train= 5.1604,5.0897 validation= 0.1831,0.2322,0.2856,0.4395 test= 0.1744,0.2226,0.2686,0.4183 [8.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 39.9379, l2 = 0.0289
WARNING:root:l2 inappropriate: loss = 39.9379, l2 = 0.0289
INFO:root:Epoch     3 [73.7 s]	 train= 5.0350,4.9099 validation= 0.1912,0.2444,0.2856,0.4522 test= 0.1861,0.2360,0.2728,0.4278 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 31.9117, l2 = 0.0369
WARNING:root:l2 inappropriate: loss = 31.9117, l2 = 0.0369
INFO:root:Epoch     4 [105.7 s]	 train= 5.6599,5.5198 validation= 0.1771,0.2325,0.2749,0.4490 test= 0.1763,0.2239,0.2696,0.4161 [11.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 25.1355, l2 = 0.0461
WARNING:root:l2 inappropriate: loss = 25.1355, l2 = 0.0461
INFO:root:Epoch     5 [150.9 s]	 train= 4.6978,4.5253 validation= 0.1961,0.2486,0.2994,0.4618 test= 0.1793,0.2300,0.2813,0.4384 [12.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 31.4009, l2 = 0.0556
WARNING:root:l2 inappropriate: loss = 31.4009, l2 = 0.0556
INFO:root:Epoch     6 [150.6 s]	 train= 5.5549,5.3254 validation= 0.2329,0.2799,0.3355,0.4820 test= 0.2003,0.2513,0.3068,0.4660 [12.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 37.8457, l2 = 0.0654
WARNING:root:l2 inappropriate: loss = 37.8457, l2 = 0.0654
INFO:root:Epoch     7 [150.5 s]	 train= 5.0430,4.8577 validation= 0.2714,0.3295,0.4045,0.5839 test= 0.2635,0.3150,0.3938,0.5531 [13.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 26.8963, l2 = 0.0744
WARNING:root:l2 inappropriate: loss = 26.8963, l2 = 0.0744
INFO:root:Epoch     8 [147.3 s]	 train= 5.6581,5.4638 validation= 0.2921,0.3570,0.4236,0.6210 test= 0.2774,0.3344,0.4023,0.5775 [12.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 27.1213, l2 = 0.0824
WARNING:root:l2 inappropriate: loss = 27.1213, l2 = 0.0824
INFO:root:Epoch     9 [137.6 s]	 train= 5.7545,5.5419 validation= 0.3215,0.3781,0.4597,0.6348 test= 0.3116,0.3621,0.4352,0.5913 [11.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 25.1586, l2 = 0.0899
WARNING:root:l2 inappropriate: loss = 25.1586, l2 = 0.0899
INFO:root:Epoch    10 [134.7 s]	 train= 5.6395,5.4828 validation= 0.3077,0.3666,0.4469,0.6285 test= 0.2867,0.3364,0.4225,0.5764 [11.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 19.3506, l2 = 0.0973
INFO:root:Epoch    11 [131.2 s]	 train= 5.4062,5.1732 validation= 0.3512,0.4084,0.5011,0.6773 test= 0.3356,0.3850,0.4915,0.6444 [11.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 11.0482, l2 = 0.1038
INFO:root:Epoch    12 [126.9 s]	 train= 4.6897,4.4623 validation= 0.3439,0.4062,0.4883,0.6794 test= 0.3096,0.3649,0.4490,0.6178 [10.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 23.4717, l2 = 0.1104
WARNING:root:l2 inappropriate: loss = 23.4717, l2 = 0.1104
INFO:root:Epoch    13 [122.2 s]	 train= 6.1425,5.9525 validation= 0.3631,0.4207,0.5255,0.7028 test= 0.3262,0.3781,0.4820,0.6423 [10.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 16.0375, l2 = 0.1167
INFO:root:Epoch    14 [128.0 s]	 train= 5.4615,5.1931 validation= 0.3511,0.4007,0.5085,0.6614 test= 0.3320,0.3863,0.4777,0.6454 [9.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.4239, l2 = 0.1229
INFO:root:Epoch    15 [114.9 s]	 train= 5.4660,5.2410 validation= 0.3376,0.3914,0.4947,0.6603 test= 0.3161,0.3717,0.4650,0.6369 [9.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 17.6698, l2 = 0.1289
INFO:root:Epoch    16 [113.9 s]	 train= 5.6324,5.4495 validation= 0.3532,0.4091,0.5085,0.6826 test= 0.3336,0.3882,0.4820,0.6507 [9.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 18.0409, l2 = 0.1352
INFO:root:Epoch    17 [115.4 s]	 train= 5.5326,5.3366 validation= 0.3562,0.4122,0.5138,0.6868 test= 0.3217,0.3825,0.4618,0.6497 [9.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 17.6149, l2 = 0.1418
INFO:root:Epoch    18 [116.2 s]	 train= 5.6088,5.3596 validation= 0.3527,0.4067,0.5021,0.6688 test= 0.3155,0.3751,0.4416,0.6253 [9.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 17.5426, l2 = 0.1480
INFO:root:Epoch    19 [114.6 s]	 train= 5.9215,5.6876 validation= 0.3544,0.4145,0.5117,0.6964 test= 0.3240,0.3840,0.4724,0.6561 [9.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 5.4236, l2 = 0.1541
INFO:root:Epoch    20 [121.2 s]	 train= 5.2773,5.0338 validation= 0.3558,0.4146,0.5064,0.6868 test= 0.3136,0.3755,0.4597,0.6497 [9.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 14.1624, l2 = 0.1601
INFO:root:Epoch    21 [110.3 s]	 train= 5.0518,4.8210 validation= 0.3502,0.4098,0.5032,0.6879 test= 0.3254,0.3842,0.4660,0.6486 [9.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 17.1907, l2 = 0.1658
INFO:root:Epoch    22 [111.0 s]	 train= 5.0319,4.7778 validation= 0.3617,0.4203,0.5074,0.6890 test= 0.3393,0.3886,0.4926,0.6444 [9.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 13.8027, l2 = 0.1718
INFO:root:Epoch    23 [108.1 s]	 train= 4.8802,4.6341 validation= 0.3666,0.4229,0.5255,0.6985 test= 0.3387,0.3924,0.4936,0.6592 [9.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 14.4549, l2 = 0.1774
INFO:root:Epoch    24 [101.1 s]	 train= 5.5193,5.3323 validation= 0.3697,0.4265,0.5234,0.6985 test= 0.3349,0.3924,0.5000,0.6762 [8.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 10.9474, l2 = 0.1834
INFO:root:Epoch    25 [99.1 s]	 train= 5.6852,5.5010 validation= 0.3694,0.4234,0.5340,0.7017 test= 0.3391,0.3915,0.4862,0.6476 [9.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 24.2322, l2 = 0.1896
INFO:root:Epoch    26 [95.3 s]	 train= 5.6562,5.3777 validation= 0.3792,0.4354,0.5414,0.7155 test= 0.3376,0.3936,0.4883,0.6603 [9.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 14.3680, l2 = 0.1958
INFO:root:Epoch    27 [95.3 s]	 train= 5.3727,5.0994 validation= 0.3640,0.4237,0.5127,0.6985 test= 0.3356,0.3895,0.4830,0.6486 [9.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.7584, l2 = 0.2017
INFO:root:Epoch    28 [92.7 s]	 train= 4.7802,4.3801 validation= 0.3559,0.4143,0.5149,0.6953 test= 0.3325,0.3871,0.4904,0.6603 [8.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 20.8079, l2 = 0.2072
INFO:root:Epoch    29 [91.4 s]	 train= 5.5521,5.2802 validation= 0.3660,0.4218,0.5255,0.6964 test= 0.3347,0.3869,0.4915,0.6507 [8.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.1637, l2 = 0.2123
INFO:root:Epoch    30 [90.9 s]	 train= 5.4124,5.1604 validation= 0.3636,0.4221,0.5265,0.7070 test= 0.3254,0.3863,0.4724,0.6614 [8.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 15.1464, l2 = 0.2181
INFO:root:Epoch    31 [90.4 s]	 train= 5.2887,5.0451 validation= 0.3668,0.4222,0.5382,0.7091 test= 0.3336,0.3888,0.4862,0.6561 [8.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 17.4068, l2 = 0.2237
INFO:root:Epoch    32 [88.6 s]	 train= 4.9401,4.5877 validation= 0.3482,0.4010,0.5064,0.6688 test= 0.3172,0.3711,0.4628,0.6295 [8.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 10.2595, l2 = 0.2294
INFO:root:Epoch    33 [86.3 s]	 train= 5.0779,4.7726 validation= 0.3826,0.4336,0.5425,0.6975 test= 0.3330,0.3914,0.4873,0.6688 [8.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 34.3071, l2 = 0.2348
INFO:root:Epoch    34 [86.2 s]	 train= 5.5641,5.2760 validation= 0.3928,0.4366,0.5594,0.6932 test= 0.3424,0.3979,0.5021,0.6730 [8.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 7.8883, l2 = 0.2405
INFO:root:Epoch    35 [87.3 s]	 train= 5.1474,4.8842 validation= 0.3697,0.4231,0.5297,0.6953 test= 0.3174,0.3743,0.4607,0.6380 [8.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 16.5787, l2 = 0.2458
INFO:root:Epoch    36 [84.9 s]	 train= 5.9428,5.7235 validation= 0.3755,0.4290,0.5435,0.7102 test= 0.3302,0.3909,0.4851,0.6730 [8.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 13.9064, l2 = 0.2519
INFO:root:Epoch    37 [86.4 s]	 train= 5.5938,5.2859 validation= 0.3975,0.4456,0.5679,0.7166 test= 0.3481,0.4074,0.5000,0.6826 [8.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 15.9333, l2 = 0.2573
INFO:root:Epoch    38 [87.6 s]	 train= 5.1803,4.6795 validation= 0.3922,0.4441,0.5701,0.7304 test= 0.3487,0.4088,0.5000,0.6858 [8.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.2810, l2 = 0.2624
INFO:root:Epoch    39 [85.5 s]	 train= 4.8456,4.5720 validation= 0.3926,0.4446,0.5637,0.7240 test= 0.3429,0.4020,0.4883,0.6709 [8.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 18.0024, l2 = 0.2675
INFO:root:Epoch    40 [84.7 s]	 train= 5.0025,4.6058 validation= 0.3875,0.4410,0.5531,0.7187 test= 0.3486,0.4053,0.5064,0.6826 [8.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 12.2448, l2 = 0.2725
INFO:root:Epoch    41 [85.4 s]	 train= 4.9443,4.6113 validation= 0.3843,0.4347,0.5626,0.7197 test= 0.3407,0.3971,0.4915,0.6656 [8.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 14.0978, l2 = 0.2775
INFO:root:Epoch    42 [88.3 s]	 train= 5.7173,5.4345 validation= 0.3900,0.4435,0.5573,0.7229 test= 0.3619,0.4189,0.5149,0.6900 [8.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 3.9740, l2 = 0.2825
INFO:root:Epoch    43 [82.6 s]	 train= 5.6363,5.3495 validation= 0.3824,0.4322,0.5446,0.6985 test= 0.3479,0.4018,0.4968,0.6645 [8.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.7078, l2 = 0.2874
INFO:root:Epoch    44 [90.6 s]	 train= 5.4482,5.2091 validation= 0.3876,0.4440,0.5478,0.7208 test= 0.3389,0.3988,0.4926,0.6773 [8.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.7426, l2 = 0.2927
INFO:root:Epoch    45 [87.1 s]	 train= 5.4997,5.2250 validation= 0.3878,0.4392,0.5552,0.7134 test= 0.3510,0.4056,0.5011,0.6699 [7.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 17.8418, l2 = 0.2975
INFO:root:Epoch    46 [88.0 s]	 train= 5.4835,5.1740 validation= 0.3931,0.4476,0.5594,0.7261 test= 0.3409,0.3988,0.5064,0.6868 [7.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.3953, l2 = 0.3031
INFO:root:Epoch    47 [88.8 s]	 train= 5.0877,4.8320 validation= 0.3864,0.4412,0.5467,0.7166 test= 0.3369,0.3996,0.4820,0.6752 [7.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.6419, l2 = 0.3087
INFO:root:Epoch    48 [87.2 s]	 train= 5.6350,5.4558 validation= 0.3927,0.4445,0.5626,0.7229 test= 0.3500,0.4034,0.4979,0.6624 [7.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.9283, l2 = 0.3140
INFO:root:Epoch    49 [89.9 s]	 train= 5.3315,5.0411 validation= 0.3904,0.4438,0.5531,0.7187 test= 0.3539,0.4061,0.4979,0.6603 [7.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.0972, l2 = 0.3194
INFO:root:Epoch    50 [87.6 s]	 train= 5.5386,5.2852 validation= 0.3878,0.4466,0.5552,0.7378 test= 0.3437,0.4039,0.4841,0.6709 [7.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 8.1498, l2 = 0.3242
INFO:root:Epoch    51 [87.8 s]	 train= 5.2400,4.9994 validation= 0.4037,0.4584,0.5669,0.7367 test= 0.3542,0.4092,0.5085,0.6783 [7.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 5.6248, l2 = 0.3288
INFO:root:Epoch    52 [73.7 s]	 train= 5.0786,4.7745 validation= 0.3910,0.4447,0.5594,0.7251 test= 0.3455,0.3982,0.5011,0.6635 [7.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 10.6683, l2 = 0.3343
INFO:root:Epoch    53 [83.2 s]	 train= 5.3055,5.0394 validation= 0.3869,0.4474,0.5478,0.7346 test= 0.3453,0.4060,0.4915,0.6783 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.5465, l2 = 0.3390
INFO:root:Epoch    54 [77.8 s]	 train= 5.5287,5.3155 validation= 0.3963,0.4479,0.5605,0.7197 test= 0.3405,0.3984,0.4851,0.6645 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.7482, l2 = 0.3434
INFO:root:Epoch    55 [79.4 s]	 train= 5.0757,4.8099 validation= 0.3909,0.4471,0.5510,0.7229 test= 0.3452,0.4039,0.4862,0.6677 [7.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.3440, l2 = 0.3484
INFO:root:Epoch    56 [79.8 s]	 train= 5.3970,5.1733 validation= 0.3842,0.4397,0.5456,0.7176 test= 0.3452,0.4016,0.4894,0.6635 [7.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.1893, l2 = 0.3525
INFO:root:Epoch    57 [79.0 s]	 train= 5.6243,5.4154 validation= 0.3853,0.4379,0.5488,0.7113 test= 0.3309,0.3834,0.4745,0.6359 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 13.9293, l2 = 0.3572
INFO:root:Epoch    58 [78.5 s]	 train= 5.0356,4.7229 validation= 0.3905,0.4498,0.5456,0.7282 test= 0.3451,0.4019,0.4926,0.6677 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 12.9436, l2 = 0.3618
INFO:root:Epoch    59 [78.5 s]	 train= 5.3216,5.0306 validation= 0.3865,0.4465,0.5467,0.7325 test= 0.3512,0.4108,0.4968,0.6805 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.6635, l2 = 0.3670
INFO:root:Epoch    60 [77.9 s]	 train= 5.9194,5.7031 validation= 0.3840,0.4415,0.5414,0.7187 test= 0.3606,0.4106,0.5170,0.6730 [7.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.1600, l2 = 0.3715
INFO:root:Epoch    61 [78.4 s]	 train= 5.4490,5.2002 validation= 0.3992,0.4536,0.5690,0.7389 test= 0.3505,0.4047,0.5021,0.6688 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.5049, l2 = 0.3761
INFO:root:Epoch    62 [77.4 s]	 train= 5.0651,4.7962 validation= 0.3897,0.4462,0.5488,0.7240 test= 0.3398,0.3934,0.4894,0.6539 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 10.3555, l2 = 0.3794
INFO:root:Epoch    63 [77.8 s]	 train= 5.3323,5.0739 validation= 0.4068,0.4653,0.5754,0.7548 test= 0.3555,0.4132,0.5074,0.6868 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 8.7381, l2 = 0.3840
INFO:root:Epoch    64 [69.7 s]	 train= 5.0448,4.7225 validation= 0.4071,0.4609,0.5669,0.7335 test= 0.3371,0.3954,0.4894,0.6699 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 6.9528, l2 = 0.3876
INFO:root:Epoch    65 [75.8 s]	 train= 5.8402,5.6438 validation= 0.4070,0.4609,0.5648,0.7314 test= 0.3412,0.3972,0.4968,0.6699 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 14.1178, l2 = 0.3924
INFO:root:Epoch    66 [78.3 s]	 train= 5.2742,4.9798 validation= 0.3953,0.4555,0.5605,0.7463 test= 0.3440,0.4008,0.4958,0.6720 [7.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.8456, l2 = 0.3970
INFO:root:Epoch    67 [78.6 s]	 train= 4.7519,4.3404 validation= 0.3890,0.4455,0.5499,0.7229 test= 0.3483,0.4017,0.4989,0.6645 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.0590, l2 = 0.4009
INFO:root:Epoch    68 [77.2 s]	 train= 4.9232,4.6518 validation= 0.3972,0.4533,0.5711,0.7420 test= 0.3526,0.4082,0.5042,0.6752 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 5.7120, l2 = 0.4049
INFO:root:Epoch    69 [78.3 s]	 train= 5.3256,5.0654 validation= 0.3919,0.4571,0.5520,0.7516 test= 0.3521,0.4050,0.5085,0.6720 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.4066, l2 = 0.4095
INFO:root:Epoch    70 [76.7 s]	 train= 5.2128,4.9653 validation= 0.3908,0.4428,0.5584,0.7187 test= 0.3346,0.3925,0.4788,0.6561 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 12.4132, l2 = 0.4138
INFO:root:Epoch    71 [79.0 s]	 train= 5.5699,5.3828 validation= 0.3971,0.4572,0.5658,0.7505 test= 0.3407,0.3956,0.5074,0.6773 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.6538, l2 = 0.4177
INFO:root:Epoch    72 [75.8 s]	 train= 4.9725,4.7229 validation= 0.3962,0.4536,0.5520,0.7304 test= 0.3412,0.3999,0.4809,0.6614 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 14.0234, l2 = 0.4218
INFO:root:Epoch    73 [75.7 s]	 train= 5.5380,5.3070 validation= 0.3873,0.4483,0.5520,0.7410 test= 0.3432,0.3977,0.4883,0.6550 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 12.4533, l2 = 0.4248
INFO:root:Epoch    74 [77.3 s]	 train= 5.6310,5.4384 validation= 0.3825,0.4471,0.5393,0.7378 test= 0.3430,0.4022,0.4894,0.6720 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 10.9027, l2 = 0.4281
INFO:root:Epoch    75 [78.0 s]	 train= 5.9313,5.7554 validation= 0.3946,0.4522,0.5563,0.7357 test= 0.3436,0.3993,0.4989,0.6699 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 13.1257, l2 = 0.4324
INFO:root:Epoch    76 [74.2 s]	 train= 5.5393,5.3290 validation= 0.3991,0.4544,0.5637,0.7335 test= 0.3479,0.4027,0.4968,0.6667 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.5401, l2 = 0.4364
INFO:root:Epoch    77 [72.5 s]	 train= 5.4083,5.1824 validation= 0.3905,0.4460,0.5594,0.7314 test= 0.3464,0.3976,0.4936,0.6507 [6.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.1617, l2 = 0.4401
INFO:root:Epoch    78 [73.5 s]	 train= 4.8461,4.5545 validation= 0.3864,0.4496,0.5382,0.7325 test= 0.3454,0.4034,0.4989,0.6783 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.1734, l2 = 0.4443
INFO:root:Epoch    79 [74.6 s]	 train= 5.7784,5.5844 validation= 0.4085,0.4581,0.5775,0.7304 test= 0.3582,0.4133,0.5308,0.7017 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:

INFO:root:loss = 4.2696, l2 = 0.4479
WARNING:root:l2 inappropriate: loss = 4.2696, l2 = 0.4479
INFO:root:Epoch    80 [74.3 s]	 train= 5.4417,5.1913 validation= 0.3962,0.4519,0.5531,0.7272 test= 0.3552,0.4042,0.5053,0.6592 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Early stop manually
INFO:root:Best Iter(validation)=    79	 train= 5.7784,5.5844 valid= 0.4085,0.4581,0.5775,0.7304 test= 0.3582,0.4133,0.5308,0.7017 [8134.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Best Iter(test)=    42	 train= 5.7173,5.4345 valid= 0.3900,0.4435,0.5573,0.7229 test= 0.3619,0.4189,0.5149,0.6900 [8134.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Load model from ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pt
INFO:root:Test After Training = 0.3563,0.4112,0.5191,0.6900 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save Test Results to ../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.9801,0.7717 validation= 0.0360,0.0529,0.0541,0.1072 test= 0.0353,0.0557,0.0594,0.1242 [7.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.9801,0.7717 validation= 0.0360,0.0529,0.0541,0.1072 test= 0.0353,0.0557,0.0594,0.1242 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.9801,0.7717 validation= 0.0360,0.0529,0.0541,0.1072 test= 0.0353,0.0557,0.0594,0.1242 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.9801,0.7717 validation= 0.0360,0.0529,0.0541,0.1072 test= 0.0353,0.0557,0.0594,0.1242 [7.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda devices: 0
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.9801,0.7717 validation= 0.0360,0.0529,0.0541,0.1072 test= 0.0353,0.0557,0.0594,0.1242 [7.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 35.5195, l2 = 0.0739
WARNING:root:l2 inappropriate: loss = 35.5195, l2 = 0.0739
INFO:root:Epoch     1 [87.4 s]	 train= 2.3519,2.1144 validation= 0.1889,0.2414,0.2792,0.4427 test= 0.1811,0.2291,0.2739,0.4236 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 43.3762, l2 = 0.0749
WARNING:root:l2 inappropriate: loss = 43.3762, l2 = 0.0749
INFO:root:Epoch     2 [82.1 s]	 train= 3.4356,3.2974 validation= 0.2010,0.2515,0.3057,0.4628 test= 0.1925,0.2420,0.2845,0.4384 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 21.0894, l2 = 0.0816
WARNING:root:l2 inappropriate: loss = 21.0894, l2 = 0.0816
INFO:root:Epoch     3 [83.0 s]	 train= 3.9081,3.4139 validation= 0.2696,0.3185,0.4055,0.5563 test= 0.2489,0.3011,0.3673,0.5308 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 23.9170, l2 = 0.0885
WARNING:root:l2 inappropriate: loss = 23.9170, l2 = 0.0885
INFO:root:Epoch     4 [82.5 s]	 train= 4.7553,4.5847 validation= 0.2550,0.3153,0.3907,0.5764 test= 0.2543,0.3073,0.3769,0.5414 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 19.3722, l2 = 0.0954
WARNING:root:l2 inappropriate: loss = 19.3722, l2 = 0.0954
INFO:root:Epoch     5 [82.7 s]	 train= 4.2474,3.8258 validation= 0.2909,0.3521,0.4321,0.6200 test= 0.2879,0.3447,0.4299,0.6062 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 20.6199, l2 = 0.1018
WARNING:root:l2 inappropriate: loss = 20.6199, l2 = 0.1018
INFO:root:Epoch     6 [82.2 s]	 train= 4.4749,4.2437 validation= 0.3129,0.3737,0.4533,0.6433 test= 0.3098,0.3611,0.4501,0.6093 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 23.9173, l2 = 0.1081
WARNING:root:l2 inappropriate: loss = 23.9173, l2 = 0.1081
INFO:root:Epoch     7 [82.2 s]	 train= 5.2653,5.0641 validation= 0.3155,0.3848,0.4639,0.6783 test= 0.3121,0.3641,0.4512,0.6125 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 16.2735, l2 = 0.1141
INFO:root:Epoch     8 [82.2 s]	 train= 4.3160,3.9759 validation= 0.3051,0.3709,0.4597,0.6624 test= 0.3116,0.3697,0.4607,0.6401 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 13.9752, l2 = 0.1201
INFO:root:Epoch     9 [82.6 s]	 train= 4.5522,4.3219 validation= 0.3212,0.3746,0.4713,0.6348 test= 0.3048,0.3585,0.4565,0.6242 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 21.3601, l2 = 0.1260
INFO:root:Epoch    10 [82.6 s]	 train= 4.9077,4.7035 validation= 0.3352,0.3932,0.4989,0.6794 test= 0.3098,0.3683,0.4586,0.6401 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 15.3870, l2 = 0.1319
INFO:root:Epoch    11 [82.3 s]	 train= 4.5513,4.2694 validation= 0.3262,0.3900,0.4809,0.6783 test= 0.3156,0.3740,0.4682,0.6497 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 12.3817, l2 = 0.1375
INFO:root:Epoch    12 [82.5 s]	 train= 4.6953,4.4382 validation= 0.3388,0.3969,0.4936,0.6741 test= 0.3108,0.3716,0.4597,0.6444 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 11.7965, l2 = 0.1431
INFO:root:Epoch    13 [82.6 s]	 train= 4.4196,4.1404 validation= 0.3413,0.4003,0.4968,0.6794 test= 0.3077,0.3664,0.4618,0.6433 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 10.1089, l2 = 0.1486
INFO:root:Epoch    14 [82.5 s]	 train= 4.1836,3.8243 validation= 0.3381,0.3993,0.4968,0.6868 test= 0.3251,0.3837,0.4703,0.6518 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 21.1805, l2 = 0.1544
INFO:root:Epoch    15 [81.4 s]	 train= 5.2442,5.0406 validation= 0.3326,0.3909,0.4904,0.6720 test= 0.3330,0.3927,0.4904,0.6752 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 1.9250, l2 = 0.1600
INFO:root:Epoch    16 [81.6 s]	 train= 5.1429,4.9523 validation= 0.3689,0.4216,0.5234,0.6879 test= 0.3121,0.3732,0.4597,0.6486 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 9.3241, l2 = 0.1657
INFO:root:Epoch    17 [79.3 s]	 train= 5.0055,4.7796 validation= 0.3510,0.4094,0.5032,0.6815 test= 0.3373,0.3952,0.4809,0.6603 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 14.0953, l2 = 0.1711
INFO:root:Epoch    18 [79.3 s]	 train= 4.4595,4.1797 validation= 0.3501,0.4112,0.4936,0.6815 test= 0.3178,0.3826,0.4544,0.6539 [6.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.7892, l2 = 0.1768
INFO:root:Epoch    19 [79.3 s]	 train= 4.8173,4.4768 validation= 0.3646,0.4201,0.5191,0.6900 test= 0.3368,0.3946,0.4862,0.6656 [6.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 15.5458, l2 = 0.1823
INFO:root:Epoch    20 [79.2 s]	 train= 5.0823,4.8561 validation= 0.3576,0.4173,0.5117,0.6943 test= 0.3283,0.3805,0.4809,0.6412 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 10.3117, l2 = 0.1879
INFO:root:Epoch    21 [79.6 s]	 train= 4.9439,4.6661 validation= 0.3610,0.4163,0.5159,0.6858 test= 0.3265,0.3814,0.4745,0.6444 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 8.8413, l2 = 0.1932
INFO:root:Epoch    22 [81.0 s]	 train= 4.5025,4.2235 validation= 0.3575,0.4157,0.5191,0.6985 test= 0.3272,0.3878,0.4682,0.6561 [6.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.8550, l2 = 0.1984
INFO:root:Epoch    23 [81.8 s]	 train= 5.0229,4.7983 validation= 0.3494,0.4072,0.5085,0.6868 test= 0.3260,0.3838,0.4586,0.6369 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.7297, l2 = 0.2037
INFO:root:Epoch    24 [91.1 s]	 train= 4.9456,4.6396 validation= 0.3759,0.4295,0.5350,0.6996 test= 0.3399,0.3969,0.4958,0.6720 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 8.1574, l2 = 0.2087
INFO:root:Epoch    25 [96.8 s]	 train= 5.2024,5.0092 validation= 0.3727,0.4259,0.5531,0.7166 test= 0.3308,0.3862,0.4915,0.6635 [7.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 10.2717, l2 = 0.2139
INFO:root:Epoch    26 [109.4 s]	 train= 5.1605,4.9237 validation= 0.3772,0.4327,0.5478,0.7187 test= 0.3480,0.4055,0.4936,0.6720 [7.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 14.6054, l2 = 0.2192
INFO:root:Epoch    27 [109.6 s]	 train= 4.9361,4.7023 validation= 0.3899,0.4428,0.5520,0.7166 test= 0.3383,0.3949,0.4862,0.6624 [8.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 10.0285, l2 = 0.2239
INFO:root:Epoch    28 [120.0 s]	 train= 5.0649,4.8294 validation= 0.3633,0.4198,0.5265,0.6996 test= 0.3212,0.3843,0.4682,0.6624 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.7255, l2 = 0.2294
INFO:root:Epoch    29 [105.8 s]	 train= 5.2861,5.0485 validation= 0.3713,0.4301,0.5329,0.7134 test= 0.3448,0.4007,0.4979,0.6709 [8.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 21.1104, l2 = 0.2346
INFO:root:Epoch    30 [107.3 s]	 train= 4.7849,4.5149 validation= 0.3556,0.4177,0.5170,0.7091 test= 0.3205,0.3845,0.4682,0.6656 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 10.8887, l2 = 0.2397
INFO:root:Epoch    31 [102.5 s]	 train= 4.6264,4.3317 validation= 0.3684,0.4255,0.5297,0.7049 test= 0.3395,0.3999,0.4915,0.6783 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 14.8957, l2 = 0.2440
INFO:root:Epoch    32 [100.6 s]	 train= 5.4942,5.3016 validation= 0.3635,0.4207,0.5340,0.7102 test= 0.3398,0.3946,0.4926,0.6603 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 5.0717, l2 = 0.2487
INFO:root:Epoch    33 [110.0 s]	 train= 5.1058,4.8880 validation= 0.3636,0.4189,0.5361,0.7081 test= 0.3227,0.3793,0.4671,0.6423 [7.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.2911, l2 = 0.2538
INFO:root:Epoch    34 [104.1 s]	 train= 4.8491,4.5301 validation= 0.3668,0.4222,0.5308,0.7028 test= 0.3247,0.3861,0.4735,0.6645 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 13.9607, l2 = 0.2586
INFO:root:Epoch    35 [87.0 s]	 train= 4.6797,4.3703 validation= 0.3658,0.4213,0.5265,0.6985 test= 0.3163,0.3823,0.4512,0.6539 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.4372, l2 = 0.2634
INFO:root:Epoch    36 [87.2 s]	 train= 5.0137,4.7630 validation= 0.3586,0.4220,0.5117,0.7059 test= 0.3204,0.3792,0.4597,0.6433 [7.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.4471, l2 = 0.2686
INFO:root:Epoch    37 [106.5 s]	 train= 4.5700,4.2416 validation= 0.3894,0.4455,0.5563,0.7282 test= 0.3595,0.4079,0.5212,0.6699 [8.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.8516, l2 = 0.2730
INFO:root:Epoch    38 [101.5 s]	 train= 5.0499,4.8208 validation= 0.3795,0.4362,0.5499,0.7251 test= 0.3351,0.3933,0.4894,0.6709 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.4724, l2 = 0.2779
INFO:root:Epoch    39 [86.2 s]	 train= 4.4824,4.1908 validation= 0.3886,0.4394,0.5605,0.7166 test= 0.3354,0.3960,0.4936,0.6805 [7.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.6882, l2 = 0.2825
INFO:root:Epoch    40 [82.7 s]	 train= 5.0855,4.8320 validation= 0.3797,0.4369,0.5552,0.7314 test= 0.3375,0.3950,0.4894,0.6667 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 11.5374, l2 = 0.2867
INFO:root:Epoch    41 [91.0 s]	 train= 4.7334,4.4351 validation= 0.3704,0.4235,0.5276,0.6921 test= 0.3101,0.3669,0.4459,0.6210 [7.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.4333, l2 = 0.2907
INFO:root:Epoch    42 [87.2 s]	 train= 5.1149,4.8676 validation= 0.3875,0.4366,0.5605,0.7123 test= 0.3312,0.3888,0.4798,0.6592 [7.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.0291, l2 = 0.2953
INFO:root:Epoch    43 [85.0 s]	 train= 5.2564,5.0507 validation= 0.3790,0.4342,0.5435,0.7134 test= 0.3258,0.3909,0.4724,0.6720 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.9210, l2 = 0.2997
INFO:root:Epoch    44 [82.9 s]	 train= 5.2378,5.0381 validation= 0.3750,0.4263,0.5446,0.7028 test= 0.3250,0.3836,0.4841,0.6656 [7.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.0390, l2 = 0.3039
INFO:root:Epoch    45 [87.8 s]	 train= 5.2395,4.9975 validation= 0.3939,0.4472,0.5563,0.7208 test= 0.3435,0.3966,0.5032,0.6667 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:

INFO:root:loss = 7.8717, l2 = 0.3078
INFO:root:Epoch    46 [84.2 s]	 train= 4.9612,4.6915 validation= 0.3803,0.4319,0.5563,0.7144 test= 0.3296,0.3872,0.4979,0.6762 [7.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 2.8131, l2 = 0.3118
WARNING:root:l2 inappropriate: loss = 2.8131, l2 = 0.3118
INFO:root:Epoch    47 [83.5 s]	 train= 4.6162,4.3160 validation= 0.3894,0.4387,0.5616,0.7134 test= 0.3366,0.3941,0.4883,0.6677 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 8.4867, l2 = 0.3166
INFO:root:Epoch    48 [84.0 s]	 train= 5.0263,4.7192 validation= 0.3800,0.4320,0.5584,0.7176 test= 0.3303,0.3875,0.4851,0.6624 [7.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.9082, l2 = 0.3205
INFO:root:Epoch    49 [87.4 s]	 train= 5.2879,5.0614 validation= 0.3902,0.4410,0.5722,0.7304 test= 0.3393,0.3978,0.4926,0.6720 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.0890, l2 = 0.3252
INFO:root:Epoch    50 [90.5 s]	 train= 5.0511,4.7706 validation= 0.3747,0.4312,0.5446,0.7187 test= 0.3255,0.3841,0.4766,0.6582 [7.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 6.0329, l2 = 0.3290
INFO:root:Epoch    51 [97.3 s]	 train= 5.4852,5.2289 validation= 0.3876,0.4417,0.5616,0.7272 test= 0.3346,0.3936,0.4936,0.6773 [7.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 8.0644, l2 = 0.3329
INFO:root:Epoch    52 [89.0 s]	 train= 4.8806,4.5234 validation= 0.3838,0.4441,0.5520,0.7378 test= 0.3397,0.3958,0.4915,0.6635 [7.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.8302, l2 = 0.3370
INFO:root:Epoch    53 [99.6 s]	 train= 5.3986,5.1612 validation= 0.3737,0.4282,0.5573,0.7240 test= 0.3300,0.3875,0.4809,0.6571 [6.9 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.3229, l2 = 0.3407
INFO:root:Epoch    54 [87.7 s]	 train= 4.9456,4.6640 validation= 0.3923,0.4397,0.5658,0.7123 test= 0.3389,0.3979,0.4936,0.6762 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 4.7345, l2 = 0.3448
INFO:root:Epoch    55 [86.9 s]	 train= 5.2647,5.0668 validation= 0.3767,0.4337,0.5456,0.7208 test= 0.3354,0.3970,0.4841,0.6730 [7.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 4.8318, l2 = 0.3487
INFO:root:Epoch    56 [90.5 s]	 train= 5.1054,4.9003 validation= 0.3906,0.4418,0.5616,0.7208 test= 0.3336,0.3953,0.4809,0.6709 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 4.1543, l2 = 0.3527
INFO:root:Epoch    57 [121.2 s]	 train= 4.6677,4.3154 validation= 0.3936,0.4474,0.5669,0.7314 test= 0.3323,0.3899,0.4820,0.6603 [7.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 8.3453, l2 = 0.3564
INFO:root:Epoch    58 [93.8 s]	 train= 5.8962,5.7090 validation= 0.3775,0.4350,0.5403,0.7166 test= 0.3298,0.3944,0.4639,0.6624 [7.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 12.6613, l2 = 0.3603
INFO:root:Epoch    59 [91.5 s]	 train= 5.5840,5.3491 validation= 0.3865,0.4363,0.5573,0.7113 test= 0.3262,0.3886,0.4713,0.6656 [7.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 9.8245, l2 = 0.3640
INFO:root:Epoch    60 [96.7 s]	 train= 5.5185,5.2557 validation= 0.3740,0.4254,0.5456,0.7028 test= 0.3280,0.3873,0.4798,0.6624 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 3.9228, l2 = 0.3674
INFO:root:Epoch    61 [105.4 s]	 train= 5.3987,5.2080 validation= 0.3725,0.4309,0.5318,0.7134 test= 0.3347,0.4013,0.4735,0.6773 [7.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.2474, l2 = 0.3717
INFO:root:Epoch    62 [95.6 s]	 train= 4.5229,4.2231 validation= 0.3596,0.4172,0.5308,0.7070 test= 0.3163,0.3790,0.4682,0.6624 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 5.1334, l2 = 0.3753
INFO:root:Epoch    63 [85.6 s]	 train= 5.2407,5.0040 validation= 0.3743,0.4250,0.5467,0.7049 test= 0.3502,0.3989,0.5042,0.6550 [7.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 8.5108, l2 = 0.3789
INFO:root:Epoch    64 [88.4 s]	 train= 5.1726,4.9463 validation= 0.3720,0.4252,0.5340,0.6985 test= 0.3325,0.3849,0.4915,0.6539 [7.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:

INFO:root:loss = 7.4457, l2 = 0.3828
INFO:root:Epoch    65 [94.6 s]	 train= 5.5766,5.3311 validation= 0.3770,0.4356,0.5435,0.7240 test= 0.3426,0.3946,0.5011,0.6614 [7.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Early stop at 65 based on validation result.
INFO:root:Best Iter(validation)=    45	 train= 5.2395,4.9975 valid= 0.3939,0.4472,0.5563,0.7208 test= 0.3435,0.3966,0.5032,0.6667 [6342.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Best Iter(test)=    37	 train= 4.5700,4.2416 valid= 0.3894,0.4455,0.5563,0.7282 test= 0.3595,0.4079,0.5212,0.6699 [6342.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Load model from ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:Test After Training = 0.3449,0.4027,0.5064,0.6847 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save Test Results to ../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.9801,0.7717 validation= 0.0360,0.0529,0.0541,0.1072 test= 0.0353,0.0557,0.0594,0.1242 [6.8 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.9801,0.7717 validation= 0.0360,0.0529,0.0541,0.1072 test= 0.0353,0.0557,0.0594,0.1242 [6.7 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0449,0.0630,0.0711,0.1285 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [9.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [9.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [9.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [6.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [9.3 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [9.4 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:Early stop manually
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [7.1 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [10.0 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [6.5 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:{'rank': 1, 'data_loader': 'DataLoader', 'model_name': 'NCR', 'runner': 'BaseRunner', 'data_processor': 'ProLogicRecDP', 'runner_name': 'ProLogicRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.txt', 'result_file': '../result/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.npy', 'random_seed': 2022, 'train': 1, 'path': '../dataset/', 'dataset': 'ml100k01-1-5', 'sep': '\t', 'label': 'label', 'u_vector_size': 64, 'i_vector_size': 64, 'r_weight': 0.1, 'ppl_weight': 0, 'pos_weight': 0, 'model_path': '../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams', 'load': 0, 'epoch': 100, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'batch_size': 128, 'eval_batch_size': 16384, 'dropout': 0.2, 'l2': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@5,ndcg@10,hit@5,hit@10', 'skip_eval': 0, 'max_his': 5, 'sup_his': 0, 'sparse_his': 1, 'test_neg_n': 100}
INFO:root:DataLoader: DataLoader
INFO:root:Model: NCR
INFO:root:Runner: ProLogicRunner
INFO:root:DataProcessor: ProLogicRecDP
INFO:root:# cuda device: cpu
INFO:root:load train csv...
INFO:root:size of train: 94638
INFO:root:load validation csv...
INFO:root:size of validation: 2334
INFO:root:load test csv...
INFO:root:size of test: 3028
INFO:root:load history csv...
INFO:root:label: 0-1
INFO:root:# of users: 944
INFO:root:# of items: 1683
INFO:root:# of user features: 0
INFO:root:# of item features: 0
INFO:root:# of context features: 0
INFO:root:# of features: 0
INFO:root:Model # of features 0
INFO:root:Model # of feature dims 0
INFO:root:# of params: 213760
INFO:root:Drop Neg Samples...
INFO:root:size of train: 53491
INFO:root:size of validation: 942
INFO:root:size of test: 942
INFO:root:Prepare Test Data...
INFO:root:Test Before Training = 0.0243,0.0432,0.0393,0.0987 ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Prepare Train Data...
INFO:root:Prepare Validation Data...
INFO:root:Init: 	 train= 0.8473,0.8473 validation= 0.0276,0.0463,0.0393,0.0977 test= 0.0243,0.0432,0.0393,0.0987 [6.6 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 35.7919, l2 = 0.0134
WARNING:root:l2 inappropriate: loss = 35.7919, l2 = 0.0134
INFO:root:Epoch     1 [78.3 s]	 train= 3.1142,2.8428 validation= 0.1817,0.2359,0.2718,0.4406 test= 0.1727,0.2217,0.2718,0.4268 [6.2 s] ndcg@5,ndcg@10,hit@5,hit@10
INFO:root:Save model to ../model/NCR/1__NCR__ml100k01-1-5__2022__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=128.pdiparams
INFO:root:Early stop manually
